<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.manyi.iw.contract.soa.server.mybatis.dao.write.custom.SaleContractOrderReceiptWriteDao">

    <select id="queryReceiptTotalMoney" parameterType="com.manyi.iw.contract.soa.api.model.vo.sale.receipt.QueryReceiptTotalMoneyParam"
            resultType="long">
        select
        if(sum(money) is null, 0, sum(money)) as totalMoney
        from iw_sale_contract_order_receipt r
        where
        r.valid = 1
        <if test="param.orderId">
            and r.orderId = #{param.orderId}
        </if>
        <if test="param.tradeId">
            and r.tradeId = #{param.tradeId}
        </if>
        <if test="param.state">
            and r.state = #{param.state}
        </if>
        <if test="param.types != null and param.types != ''">
            and r.type in
            <foreach open="(" close=")" collection="param.types" item="type" separator=",">
                #{type}
            </foreach>
        </if>
    </select>
</mapper>